
{
  "entities": {
    "CropBatch": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CropBatch",
      "type": "object",
      "description": "Represents a batch of crops stored in a storage location.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the CropBatch entity."
        },
        "cropType": {
          "type": "string",
          "description": "Type of crop in this batch (e.g., wheat, corn, rice)."
        },
        "quantity": {
          "type": "number",
          "description": "Quantity of the crop in this batch, in bags."
        },
        "storageDurationMonths": {
          "type": "number",
          "description": "The intended storage duration in months."
        },
        "storageLocationId": {
          "type": "string",
          "description": "Reference to StorageLocation. (Relationship: StorageLocation 1:N CropBatch)"
        },
        "dateAdded": {
          "type": "string",
          "description": "Date and time when the crop batch was added to storage.",
          "format": "date-time"
        },
        "storageCost": {
          "type": "number",
          "description": "Calculated storage cost for this batch."
        },
        "ownerId": {
          "type": "string",
          "description": "The UID of the user who owns this crop batch."
        }
      },
      "required": [
        "id",
        "cropType",
        "quantity",
        "storageDurationMonths",
        "storageLocationId",
        "dateAdded",
        "storageCost",
        "ownerId"
      ]
    },
    "StorageLocation": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StorageLocation",
      "type": "object",
      "description": "Represents a storage location with a specific capacity.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the StorageLocation entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the storage location (e.g., Warehouse A, Silo 1)."
        },
        "capacity": {
          "type": "number",
          "description": "Maximum capacity of the storage location, in bags."
        },
        "location": {
          "type": "string",
          "description": "Geographic location of storage (e.g., latitude, longitude)."
        },
        "ownerId": {
          "type": "string",
          "description": "The UID of the user who owns this storage location."
        }
      },
      "required": [
        "id",
        "name",
        "capacity",
        "location",
        "ownerId"
      ]
    },
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile information.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "Unique identifier for the user, matching Firebase Auth UID."
        },
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "mobileNumber": {
          "type": "string",
          "description": "The user's mobile phone number."
        }
      },
      "required": [
        "uid",
        "displayName",
        "email"
      ]
    },
    "CropType": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CropType",
      "type": "object",
      "description": "Represents a type of crop that can be stored.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the CropType."
        },
        "name": {
          "type": "string",
          "description": "Name of the crop type (e.g., Wheat, Corn)."
        },
        "ownerId": {
          "type": "string",
          "description": "The UID of the user who created this crop type."
        }
      },
      "required": [
        "id",
        "name",
        "ownerId"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/storageLocations/{storageLocationId}",
        "definition": {
          "entityName": "StorageLocation",
          "schema": {
            "$ref": "#/backend/entities/StorageLocation"
          },
          "description": "Stores storage location information owned by a user.",
          "params": [
            {
              "name": "storageLocationId",
              "description": "Unique identifier for the storage location."
            }
          ]
        }
      },
      {
        "path": "/cropBatches/{cropBatchId}",
        "definition": {
          "entityName": "CropBatch",
          "schema": {
            "$ref": "#/backend/entities/CropBatch"
          },
          "description": "Stores crop batch information owned by a user.",
          "params": [
            {
              "name": "cropBatchId",
              "description": "Unique identifier for the crop batch."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores public user profile information.",
          "params": [
            {
              "name": "userId",
              "description": "The user's unique ID."
            }
          ]
        }
      },
      {
        "path": "/cropTypes/{cropTypeId}",
        "definition": {
          "entityName": "CropType",
          "schema": {
            "$ref": "#/backend/entities/CropType"
          },
          "description": "Stores crop types defined by a user.",
          "params": [
            {
              "name": "cropTypeId",
              "description": "Unique identifier for the crop type."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to manage crop batches and storage locations for the CropSafe application. It prioritizes Authorization Independence by storing all necessary authorization data directly within the documents, avoiding hierarchical dependencies and complex `get()` calls in security rules. Access control is implemented by leveraging an 'ownerId' field on each document. This structure supports secure `list` operations by ensuring that the security rules can query based on this 'ownerId'. A `users` collection is included to store user profile information. A `cropTypes` collection is added to allow users to manage their own custom crop classifications."
  }
}
